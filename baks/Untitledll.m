hm_rd=[32819.3424	40.1793	44.8732	44.6596		0.9686	0.9745	0.9709
15714.2608	37.1631	42.9501	43.2792		0.9486	0.9631	0.9632
8247.1616	34.2027	41.3081	41.9495		0.9161	0.9506	0.9549
4621.5472	31.4453	40.1001	40.9086		0.8746	0.9396	0.9479
17852.9968	39.1717	43.7816	44.9931		0.9352	0.966	0.9786
6182.1112	37.4944	42.5424	43.0555		0.9179	0.9584	0.9709
2890.8104	35.6584	41.3062	41.2198		0.8948	0.9499	0.9612
1519.9008	33.6768	40.3819	39.9469		0.8645	0.9423	0.9523
41094.2264	37.465	42.1287	44.3058		0.9287	0.9505	0.9664
8463.2208	35.2964	40.8506	43.1615		0.9059	0.9363	0.9581
2846.0664	33.8601	39.6588	42.1219		0.8869	0.9202	0.9501
1297.0056	32.0379	38.7234	41.2828		0.8573	0.9063	0.9437
19259.4064	38.4833	40.0409	43.6153		0.9351	0.925	0.9688
6122.024	36.8668	39.0843	41.9233		0.9188	0.9108	0.958
2879.2792	34.9813	38.2602	40.372		0.894	0.8984	0.9465
1489.0608	32.8151	37.5694	39.2107		0.8538	0.8876	0.9366
4735.2632	41.5952	43.4475	45.2263		0.9596	0.9613	0.9739
2162.2608	39.7273	42.0814	43.3783		0.9465	0.95	0.9623
1054.0528	37.4232	40.8715	42.0362		0.9239	0.9387	0.9523
533.3176	35.0306	40.0153	41.2373		0.89	0.9301	0.9461
7414.5336	40.0519	42.3628	43.7565		0.9596	0.9582	0.9661
3180.0264	37.5155	40.4683	41.5029		0.9384	0.9394	0.9447
1450.548	34.9058	38.858	39.9741		0.9019	0.917	0.9245
670.4624	32.3936	37.6797	39.0755		0.8452	0.8963	0.9114
4698.3448	42.4563	45.3907	46.2461		0.962	0.9736	0.9796
2144.7144	40.5238	43.971	44.416		0.9494	0.9663	0.9718
1053.6928	38.2371	42.5734	42.7473		0.9299	0.9582	0.9635
563.1712	35.9487	41.6787	41.6534		0.9044	0.9526	0.957
3621.7448	40.5009	43.0746	43.6473		0.9659	0.9719	0.9799
1757.432	37.3945	40.7223	40.9031		0.9364	0.9587	0.9678
866.284	34.4601	38.6512	38.5875		0.8905	0.9422	0.9516
459.2904	31.9376	37.1928	36.9764		0.8377	0.9252	0.9338
7109.152	38.3142	41.461	42.5289		0.9745	0.9611	0.9704
3299.2808	34.7999	38.9519	39.8702		0.9502	0.9357	0.949
1589.572	31.6615	37.0877	37.8832		0.9095	0.9088	0.9242
770.0448	28.744	35.7883	36.4998		0.8437	0.8844	0.9013
2727.128	42.6907	46.6411	47.9533		0.9765	0.9827	0.987
1270.88	40.7424	44.7828	46.0694		0.9701	0.9753	0.982
700.7592	38.3139	43.0428	44.3009		0.9584	0.9666	0.9759
403.5072	35.5232	41.7048	42.8528		0.9369	0.9584	0.9698
1820.4464	42.9945	48.1055	48.7535		0.9712	0.9878	0.9896
695.904	41.517	46.618	47.2461		0.9649	0.9845	0.9866
355.1424	39.6534	44.9936	45.5555		0.9544	0.98	0.9825
199.6352	37.3466	43.6497	44.1034		0.9359	0.9759	0.9783
2228.3096	43.2914	47.4328	48.3874		0.9748	0.9862	0.9886
956.7064	41.5285	45.782	46.7251		0.969	0.9819	0.9848
503.4792	39.3654	44.078	45.0843		0.9595	0.9761	0.9804
285.7216	36.8153	42.715	43.6263		0.9441	0.9704	0.9757
3778.6848	40.6491	43.0258	43.5836		0.9698	0.9748	0.9813
1885.5968	37.4459	40.4279	40.6301		0.9435	0.9612	0.9688
959.0224	34.3998	38.1717	38.1578		0.9025	0.9432	0.9511
521.82	31.7182	36.4954	36.3913		0.8543	0.9229	0.931
5079.4032	42.5052	45.8434	45.9701		0.9785	0.985	0.9873
2598.3922	38.6803	43.0986	43.0034		0.958	0.9759	0.9797
1311.2107	35.0529	40.7332	40.6419		0.9293	0.9631	0.9705
680.8291	31.9126	39.2424	39.0738		0.8965	0.9534	0.9621
1333.8848	47.6609	46.3477	46.3692		0.9981	0.9849	0.9859
1002.8088	43.495	42.0912	42.1941		0.9967	0.959	0.963
759.3784	39.0435	39.4557	39.7134		0.9928	0.9247	0.938
572.3072	34.342	38.2677	38.0502		0.9795	0.9066	0.918
686.0502	50.0772	53.0056	54.0209		0.9955	0.9974	0.9975
418.9888	46.3248	49.7666	50.9649		0.992	0.9951	0.9954
264.3405	42.7267	47.1306	48.5087		0.9873	0.9921	0.9926
173.9389	39.0159	45.1593	46.6607		0.9805	0.9888	0.9896

];

x264_rd=[58392.94	41.161	44.739	44.661		0.9726	0.9733	0.9703
28874.89	37.922	42.757	43.129		0.9488	0.9609	0.9615
15164.09	34.914	41.272	41.837		0.9158	0.9491	0.9535
8766.03	32.18	39.875	40.57		0.877	0.9367	0.946
24517.92	39.928	43.883	45.158		0.9427	0.9655	0.9778
8734.23	37.661	42.336	42.889		0.916	0.9552	0.9676
3939.23	35.5	41.065	41.096		0.885	0.9463	0.9577
2124.4	33.3	39.714	39.445		0.8496	0.9368	0.9469
42679.58	39.122	41.894	43.961		0.9517	0.9462	0.9627
10677.98	35.612	40.32	42.753		0.9045	0.9272	0.954
3038.39	33.262	39.285	41.678		0.8744	0.9135	0.9469
1291.86	31.003	38.303	40.544		0.8326	0.9007	0.9405
28246.63	39.292	40.56	43.32		0.9436	0.9333	0.9667
7869.6	36.871	38.928	41.364		0.9175	0.9077	0.9538
3392.45	34.586	38.048	39.809		0.8853	0.8945	0.9419
1709.41	32.242	37.166	38.367		0.839	0.8811	0.9287
12610.74	41.52	43.487	44.989		0.9592	0.9611	0.9722
5555.72	39.381	42.035	43.115		0.9422	0.9493	0.9604
2713.15	36.811	40.846	41.757		0.913	0.9386	0.9513
1422.43	34.325	39.674	40.519		0.8727	0.9287	0.9441
17700.06	40.29	41.897	42.789		0.9599	0.9527	0.9568
7289.51	37.34	39.702	40.748		0.9327	0.9281	0.9341
3246.12	34.368	38.293	39.57		0.8848	0.9069	0.9187
1561.29	31.708	37.167	38.618		0.8151	0.8874	0.9071
12893.06	42.537	45.516	46.365		0.9628	0.9738	0.9795
5706.25	40.498	43.978	44.399		0.9481	0.966	0.9709
2951.6	38.078	42.637	42.802		0.9262	0.959	0.9634
1698.87	35.657	41.272	41.224		0.8979	0.9514	0.9555
4172.7	40.413	42.875	43.406		0.9623	0.9699	0.9775
2109.24	37.092	40.213	40.36		0.9255	0.9528	0.9611
1064.57	34.142	38.148	38.075		0.8768	0.9328	0.9411
566.34	31.527	36.55	36.241		0.8214	0.911	0.916
8532.68	39.044	41.136	41.939		0.9757	0.9557	0.9644
4085.28	35.07	38.348	39.098		0.9487	0.9247	0.9374
1864.03	31.459	36.624	37.369		0.903	0.8966	0.9127
866.52	28.329	35.301	36.032		0.8297	0.8696	0.8879
2552.77	42.377	46.259	47.434		0.9753	0.981	0.9854
1033.32	39.864	44.207	45.359		0.9663	0.9723	0.9792
520.07	37.049	42.487	43.454		0.9501	0.9632	0.9721
298.9	34.228	40.897	41.586		0.9232	0.9535	0.9647
2003.61	42.736	47.646	48.147		0.9702	0.9868	0.9883
651.92	40.469	45.65	46.081		0.9578	0.982	0.9842
280.33	37.989	43.716	43.931		0.9368	0.9765	0.9785
150.17	35.658	41.83	41.726		0.9088	0.9702	0.9728
2265	43.093	46.946	47.806		0.9744	0.9849	0.9872
865.33	40.755	44.925	45.74		0.9662	0.9791	0.9822
413.66	38.081	42.986	43.694		0.9522	0.9719	0.9759
230.17	35.422	41.29	41.585		0.9319	0.9645	0.9691
4318.09	40.55	42.681	43.19		0.9664	0.9723	0.9785
2233.24	37.158	39.78	39.967		0.9338	0.9544	0.9613
1153.24	34.063	37.512	37.556		0.8901	0.932	0.9395
624.12	31.25	35.773	35.644		0.8391	0.9072	0.9127
8967.22	42.73	45.492	45.569		0.9814	0.9835	0.9864
5013.45	38.848	42.359	42.182		0.9622	0.9714	0.9769
2694.52	35.109	40.198	39.607		0.931	0.9594	0.9658
1427.86	31.663	38.435	37.421		0.8888	0.9472	0.9531
1534.41	44.38	44.496	44.537		0.9971	0.9767	0.9784
1139.62	39.829	41.095	41.085		0.9941	0.9497	0.9542
837.45	35.188	39.125	38.975		0.9871	0.9236	0.9327
589.99	30.702	37.747	37.36		0.9646	0.9045	0.9128
1691.05	48.545	52.236	53.178		0.9945	0.9968	0.9968
1113.47	44.993	48.453	49.332		0.9909	0.9936	0.9939
725.4	41.151	45.742	46.981		0.9792	0.9899	0.9904
480.52	37.624	43.021	44.501		0.975	0.9856	0.9863
];
%seq_list={'BasketballDrill_832x480_50','BasketballPass_416x240_50','BlowingBubbles_416x240_50','BQMall_832x480_60','BQSquare_416x240_60','Flowervase_416x240_30','Flowervase_832x480_30','FourPeople_1280x720_60','Johnny_1280x720_60','Keiba_416x240_30','Keiba_832x480_30','KristenAndSara_1280x720_60','Mobisode2_416x240_30','Mobisode2_832x480_30','PartyScene_832x480_50','RaceHorses_416x240_30','RaceHorses_832x480_30','vidyo1_1280x720_60','vidyo3_1280x720_60','vidyo4_1280x720_60'};
seq_list={'PeopleOnStreet_2560x1600_30_crop',...%'Traffic_2560x1600_30_crop',
    'BasketballDrive_1920x1080_50','BQTerrace_1920x1080_60','Cactus_1920x1080_50',...
    'Kimono1_1920x1080_24','ParkScene_1920x1080_24','Tennis_1920x1080_24','BasketballDrill_832x480_50',...%'BQMall_832x480_60',
    'PartyScene_832x480_50','FourPeople_1280x720_60','Johnny_1280x720_60','KristenAndSara_1280x720_60','BasketballDrillText_832x480_50',...
    'ChinaSpeed_1024x768_30','SlideEditing_1280x720_30','SlideShow_1280x720_20'};
n=length(seq_list);
final_stats=[];
for i=1:n
   seqname=seq_list{i};
   rd1=hm_rd(4*(i-1)+1:4*(i-1)+4,:);
   rd2=x264_rd(4*(i-1)+1:4*(i-1)+4,:);
   rate1=rd1(:,1);
   psnry1=rd1(:,2);
   ssimy1=rd1(:,5);
   rate2=rd2(:,1);
   psnry2=rd2(:,2);
   ssimy2=rd2(:,5);
   rate1_log=log(rd1(:,1));
   rate2_log=log(rd2(:,1));
   ssimy1_log=-10*log10(1-ssimy1);
   ssimy2_log=-10*log10(1-ssimy2);
   all_stats=[];
   X=[ones(4,1) rate1_log];
   Y=psnry1;
   [b, bint,r,rint,stats]=regress(Y,X);
   all_stats=[all_stats stats];
   
     X=[ones(4,1) rate1_log];
   Y=ssimy1;
   [b, bint,r,rint,stats]=regress(Y,X);
   all_stats=[all_stats stats];
   
        X=[ones(4,1) rate1_log];
   Y=ssimy1_log;
   [b, bint,r,rint,stats]=regress(Y,X);
   all_stats=[all_stats stats];


      X=[ones(4,1) rate2_log];
   Y=psnry2;
   [b, bint,r,rint,stats]=regress(Y,X);
   all_stats=[all_stats stats];
   
     X=[ones(4,1) rate2_log];
   Y=ssimy2;
   [b, bint,r,rint,stats]=regress(Y,X);
   all_stats=[all_stats stats];
   
        X=[ones(4,1) rate2_log];
   Y=ssimy2_log;
   [b, bint,r,rint,stats]=regress(Y,X);
   all_stats=[all_stats stats];
   final_stats=[final_stats;all_stats];
   
   figure('Name',seqname);
   subplot(2,3,1);
   hold on, grid on
   plot(rate1,psnry1,'-rs')
   plot(rate2,psnry2,'-bs')
   legend('hm','x264')
   xlabel('Bitrate'),ylabel('PSNR')
   
   subplot(2,3,2);
   hold on, grid on
   plot(rate1,ssimy1,'-rs')
   plot(rate2,ssimy2,'-bs')
   legend('hm','x264')
   xlabel('Bitrate'),ylabel('SSIM')
   
   subplot(2,3,3);
   hold on, grid on
   plot(rate1,ssimy1_log,'-rs')
   plot(rate2,ssimy2_log,'-bs')
   legend('hm','x264')
   xlabel('Bitrate'),ylabel('-10*log(1-SSIM)')
   
   subplot(2,3,4);
   hold on, grid on
   plot(rate1_log,psnry1,'-rs')
   plot(rate2_log,psnry2,'-bs')
   legend('hm','x264')
   xlabel('log(Bitrate)'),ylabel('PSNR')
   
         subplot(2,3,5);
   hold on, grid on
   plot(rate1_log,ssimy1,'-rs')
   plot(rate2_log,ssimy2,'-bs')
   legend('hm','X264')
   xlabel('log(Bitrate)'),ylabel('SSIM')
  
      subplot(2,3,6);
   hold on, grid on

   plot(rate1_log,ssimy1_log,'-rs')
   plot(rate2_log,ssimy2_log,'-bs')
   legend('hm','x264')
   xlabel('log(Bitrate)'),ylabel('-10*log(1-SSIM)')
end
